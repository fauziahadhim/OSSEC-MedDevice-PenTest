#!/usr/bin/env python
#
# OSSEC - Fauziah Permatasari (0566100)
# fauziah.permatasari[@]vub.be
# fauziah.permatasari[@]uni-weimar.de
#

from boofuzz import *



def main():
	session = Session(
		target=Target(
			connection=SocketConnection(ip, port, proto="%s"% (proto))))


	s_initialize("user")
	s_string("USER")
	s_delim(" ")
	s_string("anonymous")
	s_static("\r\n")


	s_initialize("pass")
	s_string("PASS")
	s_delim(" ")
	s_string("admin")
	s_static("\r\n")


#	s_initialize("stor")
#	s_string("STOR")
#	s_delim(" ")
#	s_string("AAAA")
#	s_static("\r\n")


#	s_initialize("retr")
#	s_string("RETR")
#	s_delim(" ")
#	s_string("AAAA")
#	s_static("\r\n")


	session.connect(s_get("user"))
	session.connect(s_get("user"), s_get("pass"))
#	session.connect(s_get("pass"), s_get("stor"))
#	session.connect(s_get("pass"), s_get("retr"))


	session.fuzz()



def confirm():
	global yesNo
	global answer
	print "Are these information correct? %s, %i, %s"% (ip, port, proto)
	yesNo = raw_input("[Y/N]: ")
	answer = yesNo
	if answer == 'N':
		print
		getSocket()
	elif answer == 'Y':
		print
		print "Start fuzzing %s on %i/%s port"% (ip,port,proto)
		print
		main()
	elif answer != 'N' and answer != 'Y' :
		print("Invalid input.")
		print
		confirm()



def getSocket():
	global targetIP
	global fuzzPort
	global protocol
	global ip
	global port
	global proto
	targetIP = str(raw_input("Enter target's IP address: "))
	fuzzPort = int(raw_input("Enter port number to fuzz: "))
	protocol = str(raw_input("Enter protocol to use (e.g. tcp/udp): "))
	ip = targetIP
	port = fuzzPort
	proto = protocol
	confirm()



getSocket()

if answer == 'N':
	print
	getSocket()
elif answer == 'Y':
	print
	print "Start fuzzing %s on %i/%s port"% (ip,port,proto)
	print
	main()
elif answer != 'N' and answer != 'Y' :
	print("Invalid input.")
	print
	confirm()